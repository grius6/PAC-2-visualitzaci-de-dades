---
title: 'Visualització de dades: PAC2'
author: "Autor: Gerard Rius"
date: "Novembre 2025"
output:
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 4
    includes:
      in_header: 05.584-PAC-header.html
  pdf_document:
    highlight: zenburn
    toc: yes
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval=T, echo=T)
```

```{r load_libraries, include=FALSE}
# Càrrega de les llibreries a utilitzar
if (!require('dplyr')) install.packages('dplyr'); library('dplyr')
if (!require('tidyr')) install.packages('tidyr'); library('tidyr')
if (!require('stringr')) install.packages('stringr'); library('stringr')
if (!require('VIM')) install.packages('VIM'); library('VIM')
if (!require('ggplot2')) install.packages('ggplot2'); library('ggplot2')
if (!require('corrplot')) install.packages('corrplot'); library('corrplot')
if (!require('kableExtra')) install.packages('kableExtra'); library('kableExtra')
if (!require('pROC')) install.packages('pROC'); library('pROC')
if (!require('scales')) install.packages('scales'); library('scales')
if (!require('factoextra')) install.packages('factoextra'); library('factoextra')
if (!require('cluster')) install.packages('cluster'); library('cluster')
if (!require('gridExtra')) install.packages('gridExtra'); library('gridExtra')
if (!require('fpc')) install.packages('fpc'); library('fpc')
if (!require('dbscan')) install.packages('dbscan'); library('dbscan')
if (!require('ggpubr')) install.packages('ggpubr'); library('ggpubr')
if(!require('grid')) install.packages('grid'); library('grid')
if(!require('C50')) install.packages('C50'); library('C50')
if(!require('DescTools')) install.packages('DescTools'); library('DescTools')
if(!require('gmodels')) install.packages('gmodels'); library('gmodels')
if(!require('randomForest')) install.packages('randomForest'); library('randomForest')
if(!require('iml')) install.packages('iml'); library('iml')
if(!require('patchwork')) install.packages('patchwork'); library('patchwork')
if(!require('partykit')) install.packages('partykit'); library('partykit')
if(!require('rpart.plot')) install.packages('rpart.plot'); library('rpart.plot')

```

## 1 - Scatter plot

Revisió de les dades, extracció visual d'informació i preparació de les dades. Càrrega de les dades:
```{r message= FALSE, warning=FALSE}
data<-read.csv("./Final_data.csv",header=T,sep="," ,dec = ".")
```

### Exploració de la base de dades
```{r}
dim(data)
```
Es revisa les variables i el seu tipus:
```{r}
str(data)
```
Selecccio variables que interessen
```{r}
data_filtrat <- data[data$Workout_Type == "Cardio" & data$Gender == "Male", c("Weight..kg.", "Height..m.")]
```
 
```{r}
summary(data_filtrat)
```
Generar fitxer
```{r}
write.csv2(data_filtrat, "data_scaterrplot.csv", row.names = FALSE)
```

Crear gràfic
```{r}
library(ggplot2)

p <- ggplot(data_filtrat, aes(x = Height..m., y = Weight..kg.)) +
  geom_point(color = "steelblue", size = 2) +                 
  geom_smooth(method = "lm", color = "red", se = TRUE) +      
  labs(title = "Alçada vs Pes en homes que fan cardio com a exercici físic",
       x = "Alçada (m)",
       y = "Pes (kg)") +
  theme_minimal()


print(p)
```

Guardar gràfic
```{r}
ggsave("scatter.png", plot = p, width = 7, height = 5, dpi = 300)

```

## 2 - Small multiple

Revisió de les dades, extracció visual d'informació i preparació de les dades. Càrrega de les dades:
```{r message= FALSE, warning=FALSE}
data_multiple<-read.csv("./Walmart_Sales.csv",header=T,sep="," ,dec = ".")
```

### Exploració de la base de dades
```{r}
dim(data_multiple)
```

Es revisa les variables i el seu tipus:
```{r}
str(data_multiple)
```



Convertir variables
```{r}
data_multiple$Date <- as.Date(data_multiple$Date, format = "%d-%m-%Y")
data_multiple$Store <- as.factor(data_multiple$Store)
str(data_multiple)
```


Com que hi ha 45 botigues, per facilitar la comprensió em quedo amb les 10 primeres
```{r}
data_subset <- data_multiple %>%
  filter(Store %in% levels(Store)[1:8])

```

Gràfic:
```{r}

m <- ggplot(data_subset, aes(x = Date, y = Weekly_Sales)) +
  geom_line(color = "steelblue", linewidth = 0.6) +
  facet_wrap(~ Store, scales = "fixed", ncol = 4) +
  labs(
    title = "Evolució setmanal de vendes per a les 8 primeres botigues",
    x = "Anys",
    y = "Vendes setmanals ($)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    strip.text = element_text(face = "bold"),
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
print(m)
```

Guardar gràfic
```{r}
ggsave("small_multiple.png", plot = m, width = 10, height = 7, dpi = 300)

```

